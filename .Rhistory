library(tidyverse)
library(here)
# Import the data
data_covid19 <-read.csv(here::here("data/metadata.csv"))
View(data_covid19)
# Number of total patients (360)
data_covid19 %>% count(patientid) %>% nrow()
# Number of total patients with COVID (160)
data_covid19 %>% filter(finding== "COVID-19") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid) %>% nrow()
# Total of 241 Images for all the COVID 19 patients (241)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(filename) %>% nrow()
install.packages("prettydoc")
library(tidyverse)
library(here)
# Import the data
data_covid19 <-read.csv(here::here("data/metadata.csv"))
View(data_covid19)
# Number of total patients (360)
data_covid19 %>% count(patientid) %>% nrow()
# Number of total patients with COVID (160)
data_covid19 %>% filter(finding== "COVID-19") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid) %>% nrow()
# Total of 241 Images for all the COVID 19 patients (241)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(filename) %>% nrow()
only_covid <- data_covid19 %>% filter(finding== "COVID-19")
view(only_covid)
data_covid19
data_covid19
data_covid19 %>% group_by(patientid) %>% nrow()
only_covid %>% group_by(patientid) %>% nrow()
only_covid %>% count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view= "AP") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view== "AP") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid, view)
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid) %>% count(view)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid)
library(stringi)
library(stringr)
data_covid19 %>% filter(str_cont(., "COVID-19")
& modality== "X-ray") %>%  count(patientid) %>% count(view)
data_covid19 %>% filter(str_detect(., "COVID-19"))
data_covid19 %>% filter(str_detect(finding, "COVID-19"))
data_covid19 %>% filter(str_detect(finding, "COVID-19")) %>% View()
data_covid19 %>% filter(str_detect(finding, "COVID-19") & modality== "X-ray") %>% count(patientid) %>% count(view)
data_covid19 %>% filter(str_detect(finding, "COVID-19") & modality== "X-ray") %>% count(patientid)
data_covid19 %>% filter(str_detect(finding, "COVID-19") & modality== "X-ray") %>% count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid) %>% norw()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid) %>% norw()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid) %>% nrow()
data_covid19 %>% filter(str_detect(finding, "COVID-19") & modality== "X-ray") %>% count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(view)
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  group_by(patientid) %>% count(view)
data_covid19 %>% filter(str_detect(finding, "COVID-19") & modality== "X-ray") %>% count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  group_by(patientid) %>% count(view)
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view== "PA") %>%  group_by(patientid)
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view== "PA") %>%  count(patientid)
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view== "PA") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA") %>%  group_by(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA") %>%  group_by(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA") %>%  count(patientid) %>% nrow()
data_covid19 %>% filter(finding== "COVID-19" & view=="PA") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA") %>%  count(patientid) %>% nrow()
data_covid19 %>% filter(finding== "COVID-19" & view=="PA") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA") %>%  norw()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA") %>%  nrow()
data_covid19 %>% filter(finding== "COVID-19" & view=="PA") %>%  nrow()
data_covid19 %>% filter(finding== "COVID-19" & view=="PA") %>%  nrow()
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA") %>%  nrow()
data_covid19 %>% filter(finding== "COVID-19" & view=="PA") %>%  nrow()
library(keras)
library(tfruns)
here::here()
current_dir <- here::here("data/final_data")
current_dir
current_dir <- here::here("data/chestxrayCOVVIDfinal_data")
# Import the data
data_covid19 <-read.csv(here::here("data/chestxrayCOVID/metadata.csv"))
# Import the data
data_covid19 <-read.csv(here::here("data/chestxrayCOVID/metadata.csv"))
# Import the data
data_covid19 <-read.csv(here::here("data/chestxray_COVID/metadata.csv"))
current_dir <- here::here("data/chestxray_COVID/images")
final_dir <- here::here("data/final_data")
?file.copy
?list.files
# Number of x-rays we have of COVID (142)
only_covid <- data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA")
only_covid
View(only_covid)
filestocopy <- as.vector(only_covid$filename)
filestocopy
current_dir <- here::here("data/chestxray_COVID/images")
final_dir <- here::here("data/final_data")
# Copying the directories
prg_dir <- here::here("data/chestxray_COVID/images")
target_dir <- here::here("data/final_data")
# Copying the directories
org_dir <- here::here("data/chestxray_COVID/images")
lapply(filestocopy, function(x) file.copy(paste (org_dir, x , sep = "/"),paste (target_dir,x, sep = "/"), recursive = FALSE,  copy.mode = TRUE))
# Finally we copy the files
lapply(filestocopy, function(x) file.copy(paste (org_dir, x , sep = "/"),paste (target_dir,x, sep = "/"), recursive = FALSE,  copy.mode = TRUE))
# Number of x-rays we have of COVID PA angle (140)
only_covid <- data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA")
filestocopy <- as.vector(only_covid$filename)
# Copying the directories
org_dir <- here::here("data/chestxray_COVID/images")
target_dir <- here::here("data/final_data")
# Finally we copy the files
lapply(filestocopy, function(x) file.copy(paste (org_dir, x , sep = "/"),paste (target_dir,x, sep = "/"), recursive = FALSE,  copy.mode = TRUE))
# Number of x-rays we have of COVID PA angle (140)
only_covid <- data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA")
filestocopy <- as.vector(only_covid$filename)
# Copying the directories
org_dir <- here::here("data/chestxray_COVID/images")
target_dir <- here::here("data/final_data/COVID+")
# Finally we copy the files
lapply(filestocopy, function(x) file.copy(paste (org_dir, x , sep = "/"),paste (target_dir,x, sep = "/"), recursive = FALSE,  copy.mode = TRUE))
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  View()
# Number of total patients with COVID+ (160)
data_covid19 %>% filter(finding== "COVID-19") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID+ (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  View()
# Number of x-rays we have of COVID+ (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray")
# Number of x-rays we have of COVID+ (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  View()
# Here is important
# Number of x-rays we have of COVID PA angle (140)
only_covid <- data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA")
only_covid
View(only_covid)
# Number of x-rays we have of COVID+ (142)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  View()
# Total of 241 Images for all the COVID 19 patients (241)
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>%  count(filename) %>% nrow()
# Number of x-rays we have of COVID+ (142) in all the views
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>% nrow()
# Number of total patients (360)
data_covid19 %>% count(patientid) %>% nrow()
# Import the data
data_covid19 <-read.csv(here::here("data/chestxray_COVID/metadata.csv"))
# Number of total patients (360)
data_covid19 %>% count(patientid) %>% nrow()
# Number of total patients (198)
data_covid19 %>% count(patientid) %>% nrow()
# Number of total patients with all diseases (198)
data_covid19 %>% count(patientid) %>% nrow()
# Number of total patients with COVID+ (160), some of these are CT scans and not X-rays
data_covid19 %>% filter(finding== "COVID-19") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID+ (142) in all the views
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>% nrow()
# Here is important!
# Number of x-rays we have of COVID+ PA angle (140)
only_covid <- data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA")
only_covid
filter(finding== "COVID-19" & modality== "X-ray" & view=="PA") %>% nrow()
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA") %>% nrow()
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA")
length(only_covid)
nrow(length(only_covid))
# Here is important!
# Number of x-rays we have of COVID+ PA angle (140)
only_covid <- data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray" & view=="PA")
nrow(only_covid)
# Set both the directory to take the images as well as the target directory for negative COVID cases
org_dir2 <- here::here("data/kermany_OTHERS/chest_xray/test/normal")
# Set both the directory to take the images as well as the target directory for negative COVID cases
org_dir2 <- here::here("data/kermany_OTHERS/chest_xray/train/normal")
target_dir2 <- here::here("data/final_data/COVID-")
# Now list the files
jpeg <- list.files(org_dir2, pattern = ".jpg")
jpeg
# Set both the directory to take the images as well as the target directory for negative COVID cases
org_dir2 <- here::here("data/kermany_OTHERS/chest_xray/train/normal")
target_dir2 <- here::here("data/final_data/COVID-")
# Now list the files
jpeg <- list.files(org_dir2, pattern = ".jpg")
# Now list the files
jpeg <- list.files(org_dir2, pattern = ".jpeg")
jpeg
# We randomly take the same number photos as the COVID+
set.seed(5)
file.rename(jpeg, paste0("image_", sample(nrow(only_covid)), ".jpg"))
?sample
?sample
org_dir2 <- here::here("data/kermany_OTHERS/chest_xray/train/normal")
target_dir2 <- here::here("data/final_data/COVID-")
# Now list the files
jpeg <- list.files(org_dir2, pattern = ".jpeg")
# We randomly take the same number photos as the COVID+
set.seed(5)
file.rename(jpeg, paste0("image_", sample(nrow(only_covid)), ".jpg"))
filestocopy2 <- (jpeg, sample(nrow(only_covid)))
?sample_n
filestocopy2 <- sample_n(jpeg, nrow(only_covid))
class(jpeg)
type(jpeg)
?replicate
filestocopy2 <- as.vector(sample(jpeg, 5))
filestocopy2
filestocopy2 <- as.vector(sample(jpeg, nrow(only_covid)))
filestocopy2
org_dir2 <- here::here("data/kermany_OTHERS/chest_xray/train/NORMAL")
target_dir2 <- here::here("data/final_data/COVID-")
# Now list the files
jpeg <- list.files(org_dir2, pattern = ".jpeg")
# We randomly take the same number photos as the COVID+
set.seed(5)
filestocopy2 <- as.vector(sample(jpeg, nrow(only_covid)))
# Finally we copy the files as in the previous case
lapply(filestocopy2, function(x) file.copy(paste (org_dir2, x , sep = "/"),paste (target_dir2,x, sep = "/"), recursive = FALSE,  copy.mode = TRUE))
# ========
# Kermany dataset (Pneumonia BACTERIAL/VIRAL)
# ========
# Sampling Images from the kermany data for viral pneumonia to have a balanced dataset
# Set both the directory to take the images as well as the target directory for negative COVID cases
org_dir3 <- here::here("data/kermany_OTHERS/chest_xray/train/PNEUMONIA")
target_dir3 <- here::here("data/final_data/Pneumonia")
# Now list the files
jpeg2 <- list.files(org_dir3, pattern = ".jpeg")
# We randomly take the same number photos as the COVID+
set.seed(5)
filestocopy3 <- as.vector(sample(jpeg2, nrow(only_covid)))
# Finally we copy the files as in the previous case
lapply(filestocopy3, function(x) file.copy(paste (org_dir3, x , sep = "/"),paste (target_dir3,x, sep = "/"), recursive = FALSE,  copy.mode = TRUE))
# ========
# Kermany dataset part 2 (Pneumonia VIRAL)
# ========
# Sampling Images from the kermany data for VIRAL pneumonia to have a balanced dataset
# Set both the directory to take the images as well as the target directory for negative COVID cases
org_dir3 <- here::here("data/kermany_OTHERS/chest_xray/train/PNEUMONIA")
target_dir3 <- here::here("data/final_data/Pneumonia_viral")
# Now list the files
jpeg3 <- list.files(org_dir3, pattern = "VIRUS")
# We randomly take the same number photos as the COVID+
set.seed(5)
filestocopy3 <- as.vector(sample(jpeg3, nrow(only_covid)))
# Finally we copy the files as in the previous case
lapply(filestocopy3, function(x) file.copy(paste (org_dir3, x , sep = "/"),paste (target_dir3,x, sep = "/"), recursive = FALSE,  copy.mode = TRUE))
# ========
# Kermany dataset part 2 (Pneumonia BACTERIAL)
# ========
# Sampling Images from the kermany data for BACTERIAL pneumonia to have a balanced dataset
# Set both the directory to take the images as well as the target directory for negative COVID cases
org_dir4 <- here::here("data/kermany_OTHERS/chest_xray/train/PNEUMONIA")
target_dir4 <- here::here("data/final_data/Pneumonia_bacterial")
# Now list the files
jpeg4 <- list.files(org_dir4, pattern = "BACTERIA")
# We randomly take the same number photos as the COVID+
set.seed(5)
filestocopy4 <- as.vector(sample(jpeg4, nrow(only_covid)))
# Finally we copy the files as in the previous case
lapply(filestocopy4, function(x) file.copy(paste (org_dir4, x , sep = "/"),paste (target_dir4,x, sep = "/"), recursive = FALSE,  copy.mode = TRUE))
# ========
# Chestxray
# ========
# First we do a small eda analysis
# Import the data
data_covid19 <-read.csv(here::here("data/chestxray_COVID/metadata.csv"))
# Number of total patients with all diseases (198 persons)
data_covid19 %>% count(patientid) %>% nrow()
# Number of total patients with COVID+ (160 persons), some of these are CT scans and not X-rays
data_covid19 %>% filter(finding== "COVID-19") %>%  count(patientid) %>% nrow()
# We do not care about the patients but rather images which could be a replacement to data augmentation.
# Number of total patients with COVID+ (160), some of these are CT scans and not X-rays
data_covid19 %>% filter(finding== "COVID-19") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID+ (142) in all the views
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>% nrow()
# Number of x-rays we have of COVID+ (142) in all the views
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>% nrow()
# Number of total patients with COVID+ (160), some of these are CT scans and not X-rays and also includes multiples angles of the x-ray scan
data_covid19 %>% filter(finding== "COVID-19") %>%  count(patientid) %>% nrow()
# Number of x-rays we have of COVID+ (142) in all the views
data_covid19 %>% filter(finding== "COVID-19" & modality== "X-ray") %>% nrow()
install.packages("resemble")
