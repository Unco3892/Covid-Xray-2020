---
title: 'Deep Learning Project'
author: "Ilia Azizi, Alexandre Schroeter"
date: "`r format(Sys.time(), '%d %B, %Y')`"   
output:
  html_document:
    theme: cerulean
    highlight: textmate
    toc: true
    toc_float: true
bibliography: ref.bibtex
biblio-style: "apalike"
link-citations: true
---
<style type="text/css">

body{ /* Normal  */
      font-size: 18px;
  }
  
h1.title {
  font-size: 40px;
  text-align: center
}

.pad {
    padding-top: 200px; 
}

</style>


<style>
table th:first-of-type {
    width: 40%;
}
table th:nth-of-type(2) {
    width: 20%;
}
table th:nth-of-type(3) {
    width: 5%;
}
table th:nth-of-type(4) {
    width: 15%;
}
table th:nth-of-type(5) {
    width: 20%;
}
</style>


## <strong>Introduction</strong>
The COVID-19 pandemic, with the SARS-CoV-2 virus unknown only 6 months ago, has impacted our lives tremendously. To date, no vaccine or effective treatment has been found. While the "Great Lockdown" is being slowly lifted in Europe and the US, 2 sets of measures seem critical. The first one is basic hygiene gestures to prevent infection from spreading. The second is the capability of detecting and tracing every person who may have been infected and placing her in quarantine. 

At the moment, different types of testing take place -@kent_2020. The first one, accounting for a vast majority of tests, is called **polymerise chain reaction (PCR) testing**. It is searching for viral RNA and is only possible when the patient is actively infected. The test is performed using nasopharyngeal swab. This is a very labour intensive procedure, where errors are likely to occur. False negatives can be as high as 30%. 

The second category of tests is called **serologic testing**. It does not specifically search for the virus RNA but for antibodies to COVID-19. The test is carried by using a blood sample. Antibodies are produced by the body when an infection with a specific virus takes place. The antibodies are generally produced one or two weeks after infection and are useful to asses who has been in contact with the virus. This kind of test is less useful to detect an infection early and is mainly interesting for epidemiologists to give a clearer picture of the sanitary situation. The result of this test only display who has been infected but it is not possible to determine if and for how long immunity has been acquired for this virus. 

Other tests are under development, notably a **lateral flow assays** which look for a biological marker in different samples (urine, blood, saliva,...). It works just like a pregnancy test and can be used for in-home testing. Other pharmaceuticals are developing **rapid in-clinic antigen testing**. In this procedure, the analyser device uses cartridges where biological components in each cartridge is used to prove if the patient has SARS-CoV-2 or any of 9 other respiratory dieases. 

Depending on the test type and where it is performed, the price can be high. Furthermore, reagents -@heil_2020 are also a key components of most tests and are in short supply. China and the US are producers and exporters of reagents but both countries have been hit by the pandemic. 

All in all, tests are in great demand. 

Up to now, only a fraction of the population has been tested, and even if testing every person may be useless, having enough capabilities is central. 


```{r pressure, echo=FALSE, out.width = '100%', message = F, fig.cap = "Number of tests per thousand -@data_2020"}
library(here)
knitr::include_graphics(here("images/tests.png"))
```

Even small countries like Iceland or Luxembourg have only been able to carry 100 tests per thousand inhabitants. 

SARS-CoV-2 transmission is difficult to trace because symptoms can appear as long as 14 days after exposure to the virus. Most symptomatic people have fever, tiredness and a dry cough among others. People are very susceptible to developing a pneumonia. 

Another method used to confirm a diagnosis is the use of chest x-rays to detect the virus. 

However, this method also has advantages and drawbacks. First, it can be carried in almost every country becausethe material to conduct the test is ubiquitous. Second, it is less costly than a CT scan or PCR test and most of the time CT scans can only be carried in bigger hospitals. Finally, X-rays can be conducted more safely than the nasal swab method because they do not risk aerosolizing the virus when the test is conducted. 

X-rays drawbacks include increased difficulty of detecting asymptomatic cases, no at-home testing and finally the use of a radiologist needed to analyze the pictures.

Still, no method will solve the problem on its own and as explained above, a variety of methods may help overcome the shortage. For example, it could be interesting to use X-rays primarily to determine if one is COVID positive so that PCR tests may be allocated elsewhere, where X-rays cannot be used. 

Therefore, having a cheap, fast and reliable method of X-rays analysis is our motivation. -@hemdan2020covidxnet

## <strong>Research question</strong>
Thus, our research question is 

> **Can Deep Learning be used to rapidly and accurately analyze X-rays pictures to predict COVID-19 ?**

## <strong>Previous approaches </strong>
| Study               | Type of images | Number of cases                                       | Method used            | Accuracy (%) |
|---------------------|----------------|-------------------------------------------------------|------------------------|--------------|
| **Ioannis et al.** -@Apostolopoulos_2020  | Chest X-ray    | 224 COVID-19(+)<br> 700 Pneumonia<br> 504 healthy     | VGG-19                 | 93.48        |
| **Wang and Wong** -@wang2020covidnet   | Chest X-ray    | 53 COVID-19(+)<br> 5526 COVID-19(-)<br> 8066 Healthy  | COVID-NET              | 92.4         |
| **Sethy and Behra** -@articlesethy | Chest X-ray    | 25 COVID-19(+)<br> 25 COVID-19(-)                     | ResNet50+<br> SVM      | 95.38        |
| **Hemdan et al.** -@hemdan2020covidxnet  | Chest X-ray    | 25 COVID-19(+)<br> 25 Normal                          | COVIDX-Net             | 90.0         |
| **Narin et al.** -@narin2020automatic   | Chest X-ray    | 50 COVID-19(+)<br> 50 COVID-19(-)                     | Deep CNN<br> ResNet-50 | 98.0         |
| **Ozturk et al.**  -@ozturk2020automated | Chest X-ray    | 125 COVID-19(+)<br> 500 No-Findings                   | DarkCovidNet           | 98.08        |
| **Ozturk et al.**-@ozturk2020automated  | Chest X-ray    | 125 COVID-19(+)<br> 500 Pneumonia<br> 500 No-Findings | DarkCovidNet           | 87.02        |

The traditional approach consists of using Convolutional Neural Networks(CNN) to solve this task. 
Half of the previous approaches use transfer learning for the purpose. VGG_19 and ResNet50 are the pretrained networks of preference. Sethy and Behra use a Support Vector Machine on top of their CNN, at the very end of the dense layers in place of the traditional softmax activation function. 

The other half of the approaches use customized networks such as the COVIDX-Net or the DarkCovidNet whose architecture is based on the DarkNet model. The DarkNet model is a model available on MATLAB which is 19 layers deep.


## <strong>Data</strong>
As SARS-CoV-2 is a new virus, most X-rays available come from different sources. At the time being, 5 of them are worth mentionning:

a.<a href="https://cases.rsna.org/coronavirus/"> The Radiological Society of North America (RSNA)</a> <br>
b. <a href=" https://radiopaedia.org/search?utf8=%E2%9C%93&q=covid&scope=all&lang=us/"> Radiopaedia</a><br>
c. <a href="https://www.sirm.org/en/category/articles/covid-19-database/">The Italian Society of Medical and Interventional Radiology (SIRM)</a><br>
d. <a href="https://www.eurorad.org/"> Eurorad.</a><br>
e. <a href="https://coronacases.org/forum/coronacases-org-helping-radiologists-to-help-people-in-more-than-100-countries-1"> Coronacases.org</a>

As most of the data is not centralized, and therefore not always reliable, one of the leading repos on COVID-19 positive (pneumonia) X-rays is https://github.com/ieee8023/covid-chestxray-dataset. Data can be downloaded freely. 
This repo is approved by the University of Montreal's Ethics Committee and is being continuously updated. Furthermore, previous studies have already used this repo. We sample 140 pictures of it. 

To find COVID-19 negative pictures, we use another dataset provided by https://data.mendeley.com/datasets/rscbjbr9sj/3. We randomly sample 140 negative X-rays. 

Furthermore, we sample 140 bacterial pneumonia and 140 non-COVID-19 viral pneumonia. 


**THE TOTAL SIZE OF THE DATA IS**


## <strong>Methodology</strong>

## CNN models{.tabset .tabset-fade}

### Binary VGG16

```{r}
summary(cars)
```

### Binary DenseNet201
```{r}
summary(cars)
```

### Multiclass VGG16
```{r}
summary(cars)
```

### Multiclass DenseNet201
```{r}
summary(cars)
```
## <strong>References</strong>

